# 使用指南 - 5分钟上手

> 从复制到实际使用，完整流程

---

## 第一步：复制框架到项目

```bash
# 1. 复制到你的项目目录
cp -r /path/to/moveon-template/* /path/to/your-project/

# 2. 查看文件
cd /path/to/your-project/
ls -la
```

你应该看到：
```
your-project/
├── README.md
├── ai/                           ← AI 配置
│   ├── config.md
│   ├── context.md
│   ├── modes/
│   └── prompts/
├── requirements/               ← 需求文档
├── logs/                       ← 日志
├── tests/                      ← 测试
└── backups/                   ← 备份
```

---

## 第二步：配置项目上下文

### 编辑 `ai/context.md`

```markdown
## 项目信息

**项目名称**：任务管理系统

**技术栈**：
- 后端：SpringBoot 2.7 + MyBatis-Plus + MySQL
- 前端：Vue 3 + Element Plus

## 项目结构

```
src/main/java/com/task/
├── controller/
├── service/
├── mapper/
├── entity/
└── common/
```

## 当前功能

### 已完成
- [ ] 无

### 开发中
- [ ] 用户模块

## 快速导航
- 需求：requirements/
- 配置：ai/config.md
- 日志：logs/
```

---

## 第三步：开始使用

### 方式A：自动模式（快速）

```bash
# 1. 放入需求文档
cp ~/Downloads/用户需求.docx requirements/inbox/

# 2. 复制提示词给 AI
```

然后复制 `ai/prompts/auto.md` 的内容给 AI：

```
## 任务：自动开发

请阅读 requirements/inbox/ 中的需求文档，然后：

## 要求

### 1. 分析需求
- 理解业务目标
- 识别数据实体
- 明确验收标准

### 2. 开发前准备
- 查询受影响的数据
- 生成反向SQL保存到：backups/database/pre-[timestamp].sql
- 创建 Git Stash

### 3. 开发实现
- Entity → Mapper → Service → Controller
- DTO 和 VO
- 参数验证
- 异常处理

### 4. 生成日志
在 logs/[日期]/[task-id]/ 下创建：
- `changes.md` - 修改了哪些文件
- `summary.md` - 最终总结

请开始执行。
```

---

### 方式B：交互模式（可控）

```bash
# 1. 放入需求文档
cp ~/Downloads/用户需求.docx requirements/inbox/

# 2. 复制提示词给 AI
```

然后复制 `ai/prompts/interactive.md` 的内容：

```
## 任务：交互式开发

请阅读 requirements/inbox/ 中的需求文档，然后：

## 第1步：需求分析
请提出你的疑问：
1. 这个需求的核心目标是什么？
2. 涉及哪些数据实体？
3. 有哪些边界情况？

请先提出你的疑问，我会逐一回答。
```

---

## 第四步：AI 自动执行

### 自动模式的执行流程

```
你：放入需求文档 + 发送提示词
  ↓
AI：分析需求 → 设计方案
  ↓
AI：创建备份（数据库 + Git Stash）
  ↓
AI：开发代码（Entity → Mapper → Service → Controller）
  ↓
AI：自动测试
  ↓
AI：生成日志（logs/ 目录）
  ↓
AI：展示结果
  ↓
你：查看日志，确认或回滚
```

---

## 第五步：查看结果

### 查看日志

```bash
# 查看最新的日志
ls -lt logs/ | head -5

# 查看具体任务日志
cat logs/2024-01-15/task-001/summary.md
```

### 日志内容示例

**changes.md**：
```
## 修改记录

### 新增文件
1. entity/User.java
2. mapper/UserMapper.java
...

### 具体修改
### entity/User.java
- 创建用户实体类
- 使用 @TableName("t_user")
...
```

**summary.md**：
```
# 完成总结

## 任务概述
实现了用户注册、登录功能

## 技术方案
- 认证方式：JWT
- 密码加密：BCrypt

## 决策理由
为什么选择 JWT？
- 无状态，适合前后端分离
...

## 测试结果
✅ 单元测试通过
✅ 接口测试通过
```

---

## 第六步：确认或回滚

### 确认通过

```bash
# 查看测试结果
# 运行测试
mvn test

# 手动测试
# 启动项目，访问 http://localhost:8080

# 满意，移动需求
mv requirements/inbox/用户需求.docx requirements/completed/

# 清理 Git Stash
git stash drop
```

### 回滚

```bash
# 回滚数据库
mysql < backups/database/pre-task-001.sql

# 回滚代码
git stash pop

# 清理日志（可选）
rm -rf logs/2024-01-15/task-001/
```

---

## 📋 完整使用示例

### 场景：开发用户注册功能

```bash
# 1. 准备需求
cp ~/Downloads/用户注册功能.docx requirements/inbox/

# 2. 给 AI 发送提示词
# 复制 ai/prompts/auto.md 的内容

# 3. AI 执行过程
AI: 正在分析需求...
AI: 正在查询受影响的数据...
AI: 正在创建备份...
AI: 正在开发实体类...
AI: 正在开发Service...
AI: 正在测试...
AI: 完成！请查看日志

# 4. 查看结果
cat logs/2024-01-15/task-001/summary.md

# 5. 测试验证
mvn test
# 或手动测试

# 6a. 满意
mv requirements/inbox/用户注册功能.docx requirements/completed/

# 6b. 不满意，回滚
mysql < backups/database/pre-task-001.sql
git stash pop
```

---

## 🎯 常用命令速查

```bash
# 查看所有需求
ls -la requirements/inbox/

# 查看最新日志
ls -lt logs/

# 查看备份
ls -la backups/database/

# 查看 Git Stash
git stash list

# 回滚命令
mysql < backups/database/pre-task-001.sql
git stash pop
```

---

## 💡 使用技巧

### 1. 需求文档格式
- 支持文档
- 支持 Excel
- 支持 Markdown
- AI 会自动读取和分析

### 2. 选择工作模式

**使用自动模式**：
- 需求明确
- 重复性任务
- 快速验证想法

**使用交互模式**：
- 需求不清晰
- 需要技术选型讨论
- 需要逐步确认

### 3. 定期清理

```bash
# 定期清理旧的备份（保留最近7天）
find backups/ -type f -mtime +7 -delete

# 定期清理旧的日志
find logs/ -type d -mtime +30 -exec rm -rf {} \;
```

### 4. Git 历史

由于使用了 Git Stash/Patch，不会产生无用commit，Git历史保持干净：

```bash
# 查看历史
git log --oneline --graph

# 查看真实的有意义commit
git log --oneline
```

---

## ⚠️ 注意事项

1. **第一次使用**：建议使用交互模式，让 AI 充分了解项目
2. **重要功能**：使用交互模式，逐步确认
3. **简单功能**：使用自动模式，快速验证
4. **每次任务**：查看日志，了解 AI 做了什么

---

## 🆘 遇到问题？

### 问题：AI 没有创建备份
**A**: 检查 `ai/config.md` 中的备份策略，确保 AI 知道要备份

### 问题：日志不在预期位置
**A**: 检查 AI 的日志创建路径，确保日期和任务ID正确

### 问题：回滚失败
**A**:
1. 检查备份文件是否存在
2. 检查数据库连接
3. 使用 git stash list 查看 stash 是否存在

---

**开始使用吧！** 🚀

有问题随时查看 `README.md` 或 `ai/config.md`
